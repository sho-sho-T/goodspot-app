# DB Repository README（汎用テンプレート）

## 目的

`repository/db` はドメイン層で定義した Repository インターフェースの
DB 実装を提供します。ORM や DB クライアントに依存する処理はここに集約します。

このREADMEは特定ドメインに依存しない形で、リポジトリ層の役割を整理したものです。

## ファイル構成と役割

### `<Domain>Repository.ts`

- **永続化**: Domain Repository インターフェースを実装する。
- **検索**: ドメインで定義された検索メソッドを提供する。
- **保存**: create/update/delete を DB 操作に変換する。
- **変換**: DB 行をドメインエンティティに復元する。

## 実装方針（参考）

- **ドメイン境界を守る**: Repository では認可や業務ルールを持たない。
- **値オブジェクトを活用**: ID などは値オブジェクトで受け取り、
  クエリでは primitive へ変換する。
- **復元は `restore` に統一**: DB 行から `Entity.restore(...)` を使って再構築する。
- **更新は必要な列のみ**: 更新対象を明確にし、不要な変更は避ける。
- **削除方針を明確に**: 物理削除/論理削除はドメイン要件に合わせる。

## 他モジュールとの関係（参考）

- Repository は `@/external/service/*` から利用される。
- DB クライアントとスキーマは `@/external/client/db` に集約する。
